import pandas as pd
from DataBase.connection import *

def get_list_xmsx(path):
    df = pd.read_excel(path)

    data = df.iloc[3:, [1, 2]].values

    result = {i + 1: [row[0], row[1]] for i, row in enumerate(data)}

    from_xlsx = []

    for key, value in result.items():
        from_xlsx.append(value)

    return from_xlsx

def get_list_db():

    connection_db = Connecting()
    tunnel = connection_db.tooneling(jump_host='10.0.50.208', jump_port=20010, remote_host='10.10.4.139',
                                     remote_port=5432, username='martikhin',
                                     ssh_pkey='/home/ivan/.ssh/id_rsa')

    return connection_db.pg_sql(tunnel, 'EgaisNSI_test', 'repp', 'LinkedServer123',
                               "select CodeVid_egais, CodeVid_classifier from Product_Vid2021")


list_xlsx = get_list_xmsx('dictionary_of_vid_9.xlsx')
print(list_xlsx)
list_db = data = [
    ["010", "11.01.10.710"],
    ["020", "11.01.10.720"],
    ["0201", "11.01.10.790"],
    ["025", "20.14.74.140"],
    ["030", "х"],
    ["031", "11.01.10.750"],
    ["040", "х"],
    ["0401", "20.14.74.120"],
    ["050", "х"],
    ["0501", "11.01.10.740"],
    ["0502", "20.14.74.130"],
    ["0503", "20.14.74.110"],
    ["060", "х"],
    ["070", "20.14.75.110"],
    ["071", "20.14.75.210"],
    ["080", "20.14.75.120"],
    ["081", "20.14.75.220"],
    ["090", "х"],
    ["0901", "11.01.10.911"],
    ["091", "х"],
    ["092", "11.01.10.912"],
    ["100", "х"],
    ["101", "11.01.10.730"],
    ["102", "21"],
    ["1021", "10.89.19.210"],
    ["10210", "21.20.10.235"],
    ["10211", "21.20.10.239"],
    ["10212", "21.20.10.255"],
    ["10214", "21.20.10.169"],
    ["10215", "21.20.10.224"],
    ["10216", "21.20.10.111"],
    ["10217", "21.20.10.112"],
    ["10218", "21.20.10.151"],
    ["10219", "21.20.10.152"],
    ["1022", "20.13.21.120"],
    ["10220", "21.20.10.158"],
    ["10221", "21.20.10.222"],
    ["10222", "21.20.10.253"],
    ["10223", "21.20.10.254"],
    ["10224", "21.20.10.256"],
    ["10225", "21.20.10.262"],
    ["10226", "21.20.10.140"],
    ["1023", "20.20.14.000"],
    ["1024", "21.10.51.110"],
    ["1025", "21.10.51.120"],
    ["1026", "21.10.51.121"],
    ["1027", "21.10.51.122"],
    ["1028", "21.20.10.122"],
    ["1029", "21.20.10.158"],
    ["103", "21"],
    ["1031", "21.20.21.130"],
    ["104", "21"],
    ["1041", "21.20.24.160"],
    ["110", "х"],
    ["1101", "11.01.10.530"],
    ["1102", "11.01.10.531"],
    ["1103", "11.01.10.532"],
    ["1104", "11.01.10.539"],
    ["1105", "11.01.10.630"],
    ["120", "х"],
    ["1201", "[NULL]"],
    ["1202", "[NULL]"],
    ["1203", "[NULL]"],
    ["1204", "[NULL]"],
    ["130", "х"],
    ["1301", "11.01.10.520"],
    ["1302", "11.01.10.521"],
    ["1303", "11.01.10.529"],
    ["1304", "11.01.10.620"],
    ["1305", "11.01.10.621"],
    ["1306", "11.01.10.629"],
    ["140", "х"],
    ["150", "х"],
    ["1501", "11.01.10.510"],
    ["1502", "11.01.10.511"],
    ["1503", "11.01.10.519"],
    ["1504", "11.01.10.610"],
    ["1505", "11.01.10.611"],
    ["1506", "11.01.10.619"],
    ["160", "х"],
    ["161", "х"],
    ["1611", "11.01.10.540"],
    ["1612", "11.01.10.541"],
    ["1613", "11.01.10.549"],
    ["170", "х"],
    ["1701", "11.01.10.560"],
    ["180", "х"],
    ["1801", "11.01.10.570"],
    ["190", "11.01.10.580"],
    ["1901", "11.01.10.690"],
    ["1902", "11.01.10.590"],
    ["1903", "11.01.10.591"],
    ["1904", "11.01.10.599"],
    ["200", "11.01.10.111"],
    ["2001", "11.01.10.112"],
    ["2002", "11.01.10.113"],
    ["2003", "11.01.10.114"],
    ["2004", "11.01.10.119"],
    ["211", "х"],
    ["2111", "х"],
    ["2112", "11.01.10.230"],
    ["2113", "11.01.10.239"],
    ["2114", "11.01.10.250"],
    ["2115", "11.01.10.280"],
    ["212", "[NULL]"],
    ["2121", "11.01.10.215"],
    ["21210", "11.01.10.223"],
    ["21211", "11.01.10.229"],
    ["21212", "11.01.10.210"],
    ["21213", "11.01.10.211"],
    ["21214", "11.01.10.212"],
    ["21215", "11.01.10.213"],
    ["21216", "11.01.10.214"],
    ["21217", "11.01.10.219"],
    ["2122", "11.01.10.231"],
    ["2123", "11.01.10.240"],
    ["2124", "11.01.10.260"],
    ["2125", "11.01.10.270"],
    ["2126", "11.01.10.290"],
    ["2127", "11.01.10.220"],
    ["2128", "11.01.10.221"],
    ["2129", "11.01.10.222"],
    ["229", "х"],
    ["2291", "11.01.10.141"],
    ["2292", "11.01.10.146"],
    ["230", "х"],
    ["231", "11.01.10.149"],
    ["232", "11.01.10.160"],
    ["2321", "11.01.10.161"],
    ["2322", "11.01.10.162"],
    ["2323", "11.01.10.163"],
    ["2324", "11.01.10.164"],
    ["2325", "11.01.10.165"],
    ["2326", "11.01.10.166"],
    ["2327", "11.01.10.169"],
    ["233", "11.01.10.142"],
    ["2331", "11.01.10.147"],
    ["234", "х"],
    ["2341", "11.01.10.143"],
    ["235", "11.01.10.144"],
    ["2351", "11.01.10.145"],
    ["236", "11.01.10.191"],
    ["237", "11.01.10.180"],
    ["238", "х"],
    ["239", "х"],
    ["241", "х"],
    ["242", "х"],
    ["250", "х"],
    ["251", "х"],
    ["252", "11.01.10.150"],
    ["2521", "11.01.10.151"],
    ["2522", "11.01.10.152"],
    ["2523", "11.01.10.159"],
    ["260", "х"],
    ["2601", "11.01.10.400"],
    ["2602", "11.03.10.300"],
    ["2603", "11.03.10.400"],
    ["2604", "11.01.10.410"],
    ["2605", "11.01.10.490"],
    ["2606", "11.03.10.215"],
    ["2607", "11.03.10.216"],
    ["2608", "11.03.10.219"],
    ["261", "11.03.10.211"],
    ["2611", "11.03.10.214"],
    ["2612", "11.03.10.215"],
    ["2613", "11.03.10.216"],
    ["2614", "11.03.10.219"],
    ["262", "11.03.10.212"],
    ["263", "11.03.10.213"],
    ["270", "х"],
    ["280", "х"],
    ["2801", "11.01.10.121"],
    ["28010", "11.01.10.179"],
    ["28011", "11.01.10.167"],
    ["28012", "11.01.10.168"],
    ["28013", "11.01.10.192"],
    ["28014", "11.01.10.199"],
    ["28015", "11.01.10.190"],
    ["2802", "11.01.10.122"],
    ["2803", "11.01.10.123"],
    ["2804", "11.01.10.130"],
    ["2805", "11.01.10.129"],
    ["2806", "11.03.10.480"],
    ["2807", "11.01.10.170"],
    ["2808", "11.01.10.171"],
    ["2809", "11.01.10.172"],
    ["300", "х"],
    ["310", "х"],
    ["320", "х"],
    ["321", "11.02.12.210"],
    ["3211", "11.02.12.211"],
    ["3212", "11.02.12.212"],
    ["322", "х"],
    ["3221", "11.03.10.131"],
    ["3222", "11.03.10.133"],
    ["323", "х"],
    ["3231", "11.02.12.213"],
    ["3232", "11.02.12.219"],
    ["324", "х"],
    ["3241", "11.03.10.132"],
    ["3242", "11.03.10.139"],
    ["330", "11.01.10.310"],
    ["3301", "11.01.10.320"],
    ["331", "х"],
    ["340", "х"],
    ["341", "х"],
    ["3411", "11.03.10.140"],
    ["342", "х"],
    ["3421", "11.03.10.500"],
    ["343", "х"],
    ["3431", "11.05.10.140"],
    ["344", "х"],
    ["3441", "11.02.12.310"],
    ["3442", "11.02.12.321"],
    ["3443", "11.02.12.322"],
    ["3444", "11.02.12.330"],
    ["3445", "11.02.12.350"],
    ["3446", "11.02.12.360"],
    ["345", "х"],
    ["3451", "11.02.12.340"],
    ["346", "11.03.10.143"],
    ["3461", "11.03.10.141"],
    ["3462", "11.03.10.142"],
    ["3463", "11.03.10.149"],
    ["350", "х"],
    ["3501", "11.01.10.340"],
    ["3502", "11.01.10.350"],
    ["3503", "11.01.10.390"],
    ["3504", "20.53.10.120"],
    ["3505", "20.53.10.120"],
    ["3506", "20.53.10.120"],
    ["3507", "20.53.10.120"],
    ["400", "х"],
    ["401", "х"],
    ["4011", "11.02.12.111"],
    ["402", "х"],
    ["403", "х"],
    ["4031", "11.02.12.151"],
    ["4032", "11.02.12.116"],
    ["4033", "11.02.12.117"],
    ["4034", "11.02.12.118"],
    ["4035", "11.02.12.119"],
    ["4036", "11.02.12.159"],
    ["4037", "11.02.12.164"],
    ["404", "11.02.12.112"],
    ["405", "11.02.12.113"],
    ["4051", "11.02.12.113"],
    ["406", "х"],
    ["4061", "11.02.12.114"],
    ["4062", "11.02.12.115"],
    ["410", "х"],
    ["411", "11.02.12.121"],
    ["4111", "11.02.12.161"],
    ["4112", "11.02.12.162"],
    ["4113", "11.02.12.163"],
    ["4114", "11.02.12.169"],
    ["412", "х"],
    ["4121", "11.02.12.122"],
    ["413", "х"],
    ["4131", "11.02.12.123"],
    ["414", "11.02.12.152"],
    ["415", "х"],
    ["4151", "11.02.12.153"],
    ["416", "х"],
    ["420", "х"],
    ["421", "х"],
    ["4211", "11.03.10.111"],
    ["42110", "11.03.10.152"],
    ["42111", "11.03.10.159"],
    ["4212", "11.03.10.112"],
    ["4213", "11.03.10.113"],
    ["4214", "11.03.10.114"],
    ["4215", "11.03.10.115"],
    ["4216", "11.03.10.116"],
    ["4217", "11.03.10.117"],
    ["4218", "11.03.10.118"],
    ["4219", "11.03.10.151"],
    ["422", "х"],
    ["4221", "11.03.10.119"],
    ["430", "х"],
    ["4301", "х"],
    ["4302", "11.02.12.124"],
    ["431", "х"],
    ["4311", "х"],
    ["4312", "11.02.12.125"],
    ["4313", "11.02.12.129"],
    ["432", "х"],
    ["4321", "11.04.10.110"],
    ["4322", "11.04.10.120"],
    ["440", "11.02.11.111"],
    ["4401", "11.02.11.117"],
    ["4402", "11.02.11.130"],
    ["441", "11.02.11.112"],
    ["4411", "11.02.11.115"],
    ["442", "х"],
    ["4421", "11.02.11.113"],
    ["4422", "11.02.11.116"],
    ["443", "11.02.11.118"],
    ["450", "х"],
    ["4501", "11.02.11.114"],
    ["451", "х"],
    ["452", "х"],
    ["453", "х"],
    ["4531", "11.02.11.119"],
    ["460", "х"],
    ["461", "х"],
    ["4611", "11.02.12.131"],
    ["46110", "11.03.10.123"],
    ["46111", "11.03.10.124"],
    ["4612", "11.02.11.121"],
    ["4613", "11.02.11.120"],
    ["4614", "11.02.11.122"],
    ["4615", "11.02.11.129"],
    ["4616", "11.02.12.132"],
    ["4617", "11.03.10.121"],
    ["4618", "11.02.12.136"],
    ["4619", "11.02.12.137"],
    ["462", "х"],
    ["4621", "11.02.12.133"],
    ["46210", "11.02.12.140"],
    ["4622", "11.02.12.134"],
    ["4623", "11.03.10.122"],
    ["4624", "11.01.10.148"],
    ["4625", "11.02.12.135"],
    ["4626", "11.02.12.138"],
    ["4627", "11.02.12.139"],
    ["4628", "11.03.10.125"],
    ["4629", "11.03.10.129"],
    ["481", "20.42"],
    ["4811", "20.42.11.110"],
    ["48110", "20.42.15.141"],
    ["48111", "20.42.15.142"],
    ["48112", "20.42.15.143"],
    ["48113", "20.42.15.144"],
    ["48114", "20.42.15.145"],
    ["48115", "20.42.15.150"],
    ["48117", "20.42.16.110"],
    ["48119", "20.42.16.120"],
    ["4812", "20.42.11.120"],
    ["48120", "20.42.16.130"],
    ["48121", "20.42.17.110"],
    ["48122", "20.42.18.110"],
    ["48123", "20.42.19.110"],
    ["48124", "20.42.19.110"],
    ["48125", "20.42.11.120"],
    ["48126", "20.42.19.120"],
    ["48127", "20.42.11.120"],
    ["4813", "20.42.11.130"],
    ["4814", "20.42.12.110"],
    ["4815", "20.42.12.120"],
    ["4816", "20.42.15.120"],
    ["4817", "20.42.15.131"],
    ["4818", "20.42.15.132"],
    ["4819", "20.42.15.133"],
    ["482", "20.41"],
    ["4821", "20.41.32.112"],
    ["4822", "20.41.32.113"],
    ["4823", "20.41.32.114"],
    ["4824", "20.41.41.000"],
    ["4825", "20.20.11.000"],
    ["4826", "20.41.32.124"],
    ["4827", "20.41.43.110"],
    ["4828", "20.41.43.130"],
    ["483", "20.59.59.200"],
    ["484", "х"],
    ["4841", "20.59.59.190"],
    ["4842", "20.53.10.120"],
    ["485", "х"],
    ["4851", "20.59.59.110"],
    ["500", "11.05.10.120"],
    ["510", "11.05.10.130"],
    ["520", "11.05.10.160"],
    ["530", "11.03.10.410"],
    ["531", "11.03.10.420"],
    ["532", "11.03.10.430"],
    ["533", "11.03.10.440"],
    ["534", "11.03.10.450"],
    ["535", "11.03.10.460"],
    ["536", "11.03.10.490"],
    ["537", "11.03.10.470"],
    ["538", "11.02.12.190"]
]

set1 = set(map(tuple, list_xlsx))
set2 = set(map(tuple, list_db))

print("------------------")

print(set1, len(set1))
print(set2, len(set2))

# Нахождение несовпадающих элементов
difference = set1 - set2

# Преобразование результата обратно в список списков
result = [list(item) for item in difference]

# Вывод результата
print(result, len(result))


# print(get_list_db())